/**
 * MODERN BOTTOM SHEET NAVIGATION
 * Clean, polished mobile navigation that actually works
 * Fixes: proper height, smooth scrolling, perfect alignment
 */

@media screen and (max-width: 76.24em) {

  /* ============================================
     BACKDROP OVERLAY
     ============================================ */

  /* Dim backdrop when bottom sheet is open */
  #__drawer:checked ~ .md-overlay {
    opacity: 0.5 !important;
    background-color: rgba(0, 0, 0, 0.6) !important;
    backdrop-filter: blur(4px) !important;
  }

  /* ============================================
     BOTTOM SHEET CONTAINER
     ============================================ */

  .md-sidebar--primary {
    /* Fixed positioning at bottom of screen */
    position: fixed !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    top: auto !important;

    /* Full width, taller height for better content visibility */
    width: 100% !important;
    height: 85vh !important;
    max-height: 85vh !important;

    /* Styling */
    background-color: var(--md-default-bg-color) !important;
    border-top-left-radius: 24px !important;
    border-top-right-radius: 24px !important;
    box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.2) !important;

    /* Z-index management */
    z-index: 200 !important;

    /* Remove default margins/padding */
    margin: 0 !important;
    padding: 0 !important;

    /* NO overflow on container - scrolling handled inside */
    overflow: hidden !important;

    /* Smooth animation */
    transition: transform 0.4s cubic-bezier(0.4, 0.0, 0.2, 1) !important;

    /* Hardware acceleration */
    will-change: transform !important;
    transform: translateZ(0) !important;
  }

  /* HIDDEN STATE: Slide down off-screen */
  #__drawer:not(:checked) ~ .md-container .md-sidebar--primary {
    transform: translateY(100%) translateZ(0) !important;
  }

  /* VISIBLE STATE: Slide up into view */
  #__drawer:checked ~ .md-container .md-sidebar--primary {
    transform: translateY(0) translateZ(0) !important;
  }

  /* ============================================
     SCROLLABLE CONTENT AREA
     ============================================ */

  .md-sidebar--primary .md-sidebar__scrollwrap {
    /* Full height with proper scrolling */
    height: 100% !important;
    max-height: 100% !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;

    /* Styling */
    background-color: transparent !important;
    padding: 0 !important;

    /* Rounded top to match parent */
    border-top-left-radius: 24px !important;
    border-top-right-radius: 24px !important;
  }

  /* Inner navigation container */
  .md-sidebar--primary .md-sidebar__inner {
    padding: 1.5rem 1rem 2rem !important;
    min-height: 100% !important;
  }

  /* ============================================
     DRAG HANDLE AREA
     ============================================ */

  /* Space at top for drag handle (added by JS) */
  .md-sidebar--primary .md-sidebar__scrollwrap::before {
    content: '' !important;
    display: block !important;
    height: 32px !important;
    flex-shrink: 0 !important;
  }

  /* ============================================
     NAVIGATION ITEMS
     ============================================ */

  /* All nav elements visible and interactive */
  .md-sidebar--primary .md-nav,
  .md-sidebar--primary .md-nav__item,
  .md-sidebar--primary .md-nav__link,
  .md-sidebar--primary .md-nav__toggle,
  .md-sidebar--primary .md-nav__icon {
    pointer-events: auto !important;
    opacity: 1 !important;
    visibility: visible !important;
  }

  /* Navigation links - large, thumb-friendly */
  .md-sidebar--primary .md-nav__link {
    min-height: 52px !important;
    padding: 0.9rem 1.2rem !important;
    font-size: 1rem !important;
    font-weight: 500 !important;
    color: var(--md-default-fg-color) !important;

    /* Flexbox for alignment */
    display: flex !important;
    align-items: center !important;

    /* Rounded corners */
    border-radius: 12px !important;

    /* Smooth transitions */
    transition: all 0.2s ease !important;
  }

  /* Hover/press feedback */
  .md-sidebar--primary .md-nav__link:hover {
    background-color: rgba(103, 158, 255, 0.08) !important;
  }

  .md-sidebar--primary .md-nav__link:active {
    background-color: rgba(103, 158, 255, 0.15) !important;
    transform: scale(0.98) !important;
  }

  /* Active/current page */
  .md-sidebar--primary .md-nav__link--active {
    background-color: rgba(103, 158, 255, 0.12) !important;
    color: var(--md-accent-fg-color) !important;
    font-weight: 600 !important;
  }

  /* Spacing between items */
  .md-sidebar--primary .md-nav__item {
    margin: 0.25rem 0 !important;
  }

  /* ============================================
     NESTED NAVIGATION
     ============================================ */

  /* Toggle button for nested items */
  .md-sidebar--primary .md-nav__toggle {
    display: block !important;
    position: absolute !important;
    right: 0.5rem !important;
    top: 0 !important;
    width: 52px !important;
    height: 52px !important;
    cursor: pointer !important;
    z-index: 1 !important;
  }

  /* Nested navigation (hidden by default) */
  .md-sidebar--primary .md-nav__item .md-nav {
    display: none !important;
    background-color: rgba(0, 0, 0, 0.03) !important;
    border-radius: 8px !important;
    margin-top: 0.25rem !important;
    padding: 0.5rem 0 !important;
  }

  /* Show when toggle is checked */
  .md-sidebar--primary .md-nav__toggle:checked ~ .md-nav {
    display: block !important;
  }

  /* Nested links (smaller, indented) */
  .md-sidebar--primary .md-nav__item .md-nav .md-nav__link {
    font-size: 0.9rem !important;
    min-height: 44px !important;
    padding: 0.7rem 1rem 0.7rem 2rem !important;
  }

  /* Hide nested nav title */
  .md-sidebar--primary .md-nav__item .md-nav .md-nav__title {
    display: none !important;
  }

  /* ============================================
     DARK MODE SUPPORT
     ============================================ */

  [data-md-color-scheme="slate"] .md-sidebar--primary {
    background-color: #1e1e1e !important;
    box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.5) !important;
  }

  [data-md-color-scheme="slate"] .md-sidebar--primary .md-nav__item .md-nav {
    background-color: rgba(255, 255, 255, 0.05) !important;
  }

  /* ============================================
     ACCESSIBILITY
     ============================================ */

  /* Focus states */
  .md-sidebar--primary .md-nav__link:focus-visible {
    outline: 2px solid var(--md-accent-fg-color) !important;
    outline-offset: 2px !important;
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .md-sidebar--primary {
      transition: none !important;
    }
  }

}

/* ============================================
   DESKTOP: Hide bottom sheet styles
   ============================================ */

@media screen and (min-width: 76.25em) {
  .md-sidebar--primary {
    /* Reset to normal sidebar positioning */
    position: static !important;
    height: auto !important;
    max-height: none !important;
    transform: none !important;
    border-radius: 0 !important;
    box-shadow: none !important;
  }
}
