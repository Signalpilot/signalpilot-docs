{% extends "base.html" %}

{% block extrahead %}
  {{ super() }}
  <script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
        pageLanguage: 'en',
        includedLanguages: 'es,fr,de,pt,ja,zh-CN,zh-TW,ko,ru,it,nl,pl,tr,ar,hi,id,th,vi',
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
        autoDisplay: false
      }, 'google_translate_element');

      // Add flags to language options after the widget loads
      setTimeout(addLanguageFlags, 1000);
    }

    function addLanguageFlags() {
      var flagMap = {
        'en': 'ğŸ‡¬ğŸ‡§',
        'es': 'ğŸ‡ªğŸ‡¸',
        'fr': 'ğŸ‡«ğŸ‡·',
        'de': 'ğŸ‡©ğŸ‡ª',
        'pt': 'ğŸ‡µğŸ‡¹',
        'ja': 'ğŸ‡¯ğŸ‡µ',
        'zh-CN': 'ğŸ‡¨ğŸ‡³',
        'zh-TW': 'ğŸ‡¹ğŸ‡¼',
        'ko': 'ğŸ‡°ğŸ‡·',
        'ru': 'ğŸ‡·ğŸ‡º',
        'it': 'ğŸ‡®ğŸ‡¹',
        'nl': 'ğŸ‡³ğŸ‡±',
        'pl': 'ğŸ‡µğŸ‡±',
        'tr': 'ğŸ‡¹ğŸ‡·',
        'ar': 'ğŸ‡¸ğŸ‡¦',
        'hi': 'ğŸ‡®ğŸ‡³',
        'id': 'ğŸ‡®ğŸ‡©',
        'th': 'ğŸ‡¹ğŸ‡­',
        'vi': 'ğŸ‡»ğŸ‡³'
      };

      var selectElement = document.querySelector('.goog-te-combo');
      if (selectElement) {
        var options = selectElement.options;
        for (var i = 0; i < options.length; i++) {
          var option = options[i];
          var langCode = option.value;
          if (langCode && flagMap[langCode]) {
            option.text = flagMap[langCode] + ' ' + option.text;
          }
        }
      } else {
        // Retry if element not found
        setTimeout(addLanguageFlags, 500);
      }
    }
  </script>
  <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
  <style>
    /* Style the Google Translate widget container */
    #google_translate_element {
      display: inline-block;
    }

    /* Hide the "Powered by" text and Google branding */
    .goog-te-gadget {
      font-family: 'Roboto', sans-serif !important;
      font-size: 0 !important;
    }

    /* Style the select dropdown */
    .goog-te-combo {
      background-color: var(--md-default-bg-color) !important;
      color: var(--md-default-fg-color) !important;
      border: 1px solid var(--md-primary-fg-color) !important;
      border-radius: 4px !important;
      padding: 6px 32px 6px 8px !important;
      font-family: 'Roboto', sans-serif !important;
      font-size: 14px !important;
      cursor: pointer !important;
      background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12"><path fill="%23666" d="M10.293 3.293L6 7.586 1.707 3.293A1 1 0 00.293 4.707l5 5a1 1 0 001.414 0l5-5a1 1 0 10-1.414-1.414z"/></svg>') !important;
      background-repeat: no-repeat !important;
      background-position: right 8px center !important;
      appearance: none !important;
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
    }

    .goog-te-combo:hover {
      background-color: var(--md-accent-fg-color--transparent) !important;
    }

    .goog-te-combo:focus {
      outline: 2px solid var(--md-primary-fg-color) !important;
      outline-offset: 2px !important;
    }

    /* Add flag icon before the dropdown */
    #google_translate_element::before {
      content: 'ğŸŒ';
      font-size: 20px;
      margin-right: 8px;
      vertical-align: middle;
    }

    /* Hide the gadget span with "Select Language" */
    .goog-te-gadget-simple {
      background-color: transparent !important;
      border: none !important;
      padding: 0 !important;
      display: inline-flex !important;
      align-items: center !important;
    }

    .goog-te-gadget-simple .goog-te-menu-value {
      color: var(--md-default-fg-color) !important;
      vertical-align: middle !important;
    }

    .goog-te-gadget-simple .goog-te-menu-value span {
      border-left: none !important;
      color: var(--md-default-fg-color) !important;
    }

    .goog-te-gadget-simple .goog-te-menu-value span:first-child {
      display: none !important; /* Hide "Select Language" text */
    }

    /* Hide Google Translate banner */
    .goog-te-banner-frame.skiptranslate {
      display: none !important;
    }

    body {
      top: 0px !important;
    }

    /* Container for translate widget in header */
    .md-header__translate {
      display: flex;
      align-items: center;
      margin-left: auto;
      padding-right: 12px;
    }

    /* Language flags mapping */
    .goog-te-combo option[value=""] {
      display: none;
    }

    /* Style for language options */
    .goog-te-combo option {
      padding: 8px;
      font-size: 14px;
    }

    /* Mobile responsiveness */
    @media screen and (max-width: 76.1875em) {
      #google_translate_element::before {
        font-size: 18px;
        margin-right: 4px;
      }

      .goog-te-combo {
        font-size: 13px !important;
        padding: 4px 28px 4px 6px !important;
      }
    }

    /* Dark mode adjustments */
    [data-md-color-scheme="slate"] .goog-te-combo {
      background-color: var(--md-default-bg-color) !important;
      color: var(--md-default-fg-color) !important;
    }
  </style>
{% endblock %}

{% block header %}
  {{ super() }}
  <div class="md-header__translate">
    <div id="google_translate_element"></div>
  </div>
{% endblock %}
